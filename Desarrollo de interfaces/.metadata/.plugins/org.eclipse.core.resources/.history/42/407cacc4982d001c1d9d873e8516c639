package ctrl;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.StringTokenizer;

import model.Persona;

public class CtrlPrincipal {

	public static void inicio() {
			
		new view.FrmPrincipal();
		
		File fichero = new File("telefonos.txt");
		
		ArrayList<Persona> gente = leerPersona(fichero);
		gente.forEach(p -> System.out.println(p));
	}
	
	public static ArrayList<Persona> leerPersona(File fichero) {		
		
		ArrayList<Persona> contenido = new ArrayList<Persona>();
		
		try {
			FileReader fch = new FileReader(fichero);
			BufferedReader bufLectura = new BufferedReader(fch);
			
			String lineaLeida;
			lineaLeida = bufLectura.readLine(); 
			
			while(lineaLeida != null) {
				//A continuacion proceso la linea leida...
				StringTokenizer campo = new StringTokenizer(lineaLeida, "#");//Para borrar las almohadillas que haya escrita
				String nombre = campo.nextToken();
				String telefono = campo.nextToken();
				
				contenido.add(new Persona(nombre, Integer.parseInt(telefono)));
				
				//Realizamos una nueva lectura
				lineaLeida = bufLectura.readLine();
			}
			
			bufLectura.close();
			fch.close();
			
		} catch (FileNotFoundException e) {
			System.err.println("El fichero " + fichero + " no existe");
		} catch (IOException e) {
			System.err.println("Se ha producido un error accediendo a " + fichero);
		}
		
		return contenido;
		
	}

	public void escribirRegistro(int numReg, Persona persona) {
		try {
			long posicion = getPosicion(numReg);
			fch.seek(posicion);
			
			//nombre
			String nombre = empleado.getNombre();
			char letra;
			for (int i = 0; i < 5; i++) {
				letra = (i < nombre.length()) ? nombre.charAt(i) : ' ';
				fch.writeChar(letra);
			}
			
			//edad
			fch.writeInt(empleado.getEdad());
			
			//altura
			fch.writeDouble(empleado.getAltura());
			
		} catch (IOException e) {
			System.err.println("El archivo no es accesible");
		}
	}
			
}
